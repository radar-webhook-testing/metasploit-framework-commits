<%
	modlist = @exploits
	modname = params[:id]
	modinst = nil
	
	if (modname)
		modlist.each do |m|
			if (m.refname == modname)
				modinst = m
				break
			end
		end
	end
	
	# Default to first module?
	if (not modinst)
		modinst = modlist[0]
		modname = modinst.refname
	end
%>

<table width="100%" cellspacing="0" cellpadding="0" border="0">
	<tr>
		<td class="moduleName">
			<%= html_escape(modinst.name) %>
		</td>
	</tr>
</table>
<br/>

<table align="center" width="95%" cellspacing="0" cellpadding="6" border="0">
	<tr>
		<td align="right" width="80">Name:</td>
		<td><%= html_escape(modinst.name) %></td>
	</tr>
	<tr>
		<td align="right" width="80">Authors:</td>
		<td><%= html_escape(modinst.author.join("<br/>")) %></td>
	</tr>
	<tr>
		<td align="right" width="80" valign="top">Description:</td>
		<td colspan="2" valign="top">
			<%= html_escape(modinst.description) %>
		</td>
	</tr>
	<tr>
		<td align="right" width="80" valign="top">References:</td>
		<td colspan="2" valign="top">
			<% modinst.references.each { |ref| %>
					<% if (ref.kind_of?(Msf::Module::SiteReference)) %>
					- <a href="<%= ref.site %>" target="_blank"><%= ref.to_s %></a><br/>
			<% 	else %>
					- <%= ref.to_s %><br/>
			<% 	end %>
			<% } %>
		</td>
	</tr>
	<tr>
		<td align="right" width="80">Targets:</td>
		<td>&nbsp;</td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td>
			<table align="align" cellpadding="2" cellspacing="0" border="0">
				<tr>
					<td>Target Name</td>
					<td>Platform</td>
				</tr>
				<% modinst.targets.each_with_index { |tgt, idx| %>
				<tr>
					<td class="target<%= (idx % 2 == 0) ? "B" : "A" %>" align="left">
						<%= idx %> - <a href='#'><%= tgt.name %></a>
					</td>
					<td class="target<%= (idx % 2 == 0) ? "B" : "A" %>" align="left">
						#ICON#
					</td>
				</tr>
				<% } %>
			</table>
		</td>
	</tr>
</table>

<%

	modidx  = (params[:id] || 0).to_i	
	modinst = @all_exploits[modidx]
%>

<table width='100%' cellspacing='0' cellpadding='0' border='0'>
	<tr>
		<td class='moduleName'>
			<div class='textBold'><%= html_escape(modinst.name) %></div>
		</td>
	</tr>
</table>
<br/>

<table align='center' width='95%' cellspacing='0' cellpadding='6' border='0'>
	<tr>
		<td align='right' width='80' class='textBold'>Name:</td>
		<td class='textNormal'><%= html_escape(modinst.name) %></td>
	</tr>
	<tr>
		<td align='right' width='80' class='textBold'>Authors:</td>
		<td class='textNormal'><%= html_escape(modinst.author.join("<br/>")) %></td>
	</tr>
	<tr>
		<td align='right' width='80' class='textBold' valign='top'>Description:</td>
		<td colspan='2' class='textNormal' valign='top'>
			<%= html_escape(modinst.description) %>
		</td>
	</tr>
	<tr>
		<td align='right' width='80' class='textBold' valign='top'>References:</td>
		<td colspan='2' class='textNormal' valign='top'>
			<% modinst.references.each { |ref| %>
					<% if (ref.kind_of?(Msf::Module::SiteReference)) %>
					- <a href='<%= ref.site %>' target='_blank'><%= ref.to_s %></a><br/>
			<% 	else %>
					- <%= ref.to_s %><br/>
			<% 	end %>
			<% } %>
		</td>
	</tr>
	<tr>
		<td align='right' width='80' class='textBold'>Targets:</td>
		<td class='textNormal'>&nbsp;</td>
	</tr>
	<tr>
		<td>&nbsp;</td>
		<td>
			<table align='align' cellpadding='2' cellspacing='0' border='0'>
				<tr>
					<td class='textBold'>Target Name</td>
					<td class='textBold'>Platform</td>
				</tr>
				<% modinst.targets.each_with_index { |tgt, idx| %>
				<tr>
					<td class='textBoldColor<%= (idx % 2 == 0) ? "B" : "A" %>' align='left'>
						<%= idx %> - <a href='#'><%= tgt.name %></a>
					</td>
					<td class='textBoldColor<%= (idx % 2 == 0) ? "B" : "A" %>' align='left'>
						#ICON#
					</td>
				</tr>
				<% } %>
			</table>
		</td>
	</tr>
</table>

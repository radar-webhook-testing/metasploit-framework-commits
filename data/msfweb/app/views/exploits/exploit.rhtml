<table align="center" width="100%" cellspacing="0" cellpadding="3" border="0" class="moduleInfo">
    
	<tr width="100%" align="center">
        <p class="moduleName">
            <%= h(@tmod.name) %><br />
        </p>
    </tr>

<% if @cur_step == nil %>

    <p>Select payload for <strong><%= h(@target.name) %></strong>:</p>

    <tr>
        <th class="moduleOptionsHeader">Name</th>
        <th class="moduleOptionsHeader">Description</th>
    </tr>

    <% @payloads.each_with_index do |p, idx| %>
    <tr><% o = p[1].new %>
        <td><%= link_to h(p[0]), :refname => @tmod.refname.gsub('/', ':'), :step => "config",
        :target => h(params[:target].to_i), :payload => idx %></td>
        <td><%= h(o.description) %></td>
    </tr>
    <% end %>
    
<% elsif @cur_step == "config" %>

    <p>Exploit and payload configuration:</p>
    
    <tr>
        <th colspan="2">CURRENT CONFIGURATION</th>
    </tr>
    <tr>
        <td>Target:</td>
        <td><%= @target.name %></td>
    <tr>
    <tr>
        <td>Exploit:</td>
        <td><%= @tmod.refname %></td>
    <tr>
    <tr>
        <td>Payload:</td>
        <td><%= @payload[0] %></td>
    <tr>
    
    <tr>
        <th colspan="2">OPTIONS</th>
    </tr>
    
    <form action="/exploits/exploit" method="post">
        <%= hidden_field_tag "refname", h(params[:refname]) %>
        <%= hidden_field_tag "step", "ready" %>
        <%= hidden_field_tag "target", h(params[:target]) %>
        <%= hidden_field_tag "payload", h(params[:payload]) %>
    </form>
    
<% end %>

</table>

<table align="center" width="100%" cellspacing="0" cellpadding="3" border="0" class="moduleInfo">
    
	<tr width="100%" align="center">
        <p class="moduleName">
            Exploit: <%= h(@tmod.name) %> (<%= h(params[:refname].gsub(':', '/')) %>)<br />
        </p>
    </tr>

<% if @cur_step == nil %>

    <p>Select payload for <strong><%= h(@target.name) %></strong>:</p>

    <tr>
        <th class="moduleOptionsHeader">Name</th>
        <th class="moduleOptionsHeader">Description</th>
    </tr>

    <% @payloads.each do |p| %>
    <tr><% o = p[1].new %>
        <td><%= link_to h(p[0]), :refname => @tmod.refname.gsub('/', ':'), :step => "config",
        :target => h(params[:target].to_i), :payload => o.refname.gsub('/', ':') %></td>
        <td><%= h(o.description) %></td>
    </tr>
    <% end %>
    
<% elsif @cur_step == "config" %>

    <p>Exploit and payload configuration:</p>

    <form action="/exploits/exploit" method="post">
        <%= hidden_field_tag "refname", h(params[:refname]) %>
        <%= hidden_field_tag "step", "ready" %>
        <%= hidden_field_tag "target", h(params[:target]) %>
        <%= hidden_field_tag "payload", h(params[:payload]) %>
    </form>
    
<% end %>

</table>

#!/usr/bin/ruby

$:.unshift(File.join(File.dirname(__FILE__), '..', '..', '..', '..'))

require 'test/unit'
require 'Msf/Core'

module Msf

class Exploit::Remote::Tcp::UnitTest < Test::Unit::TestCase

	class Stub < Msf::Exploit::Remote
		include Msf::Exploit::Remote::Tcp
	end

	def test_tcp
		e = Stub.new

		assert_equal(4, e.options.length, "invalid options length")
		assert_equal(true, e.options.get('RHOST').required?, "invalid RHOST requirement")
		assert_equal(true, e.options.get('RPORT').required?, "invalid RPORT requirement")
		assert_equal(false, e.options.get('LHOST').required?, "invalid LHOST requirement")
		assert_equal(false, e.options.get('LPORT').required?, "invalid LPORT requirement")
	end

end

end
